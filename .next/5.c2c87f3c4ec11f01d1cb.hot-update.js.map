{"version":3,"file":"5.c2c87f3c4ec11f01d1cb.hot-update.js","sources":["webpack:///pages/admin-login.js"],"sourcesContent":["\nimport fetch from 'isomorphic-unfetch'\nimport React, { Component } from 'react'\nimport Layout from '../components/admin/Layout';\nimport Router from 'next/router'\nimport Snackbar from 'material-ui/Snackbar';\n\n\nconst initialState = {\n  saving: false,\n  save: false,\n  user: {\n      firstName: '',\n      lastName: '',\n      email: '',\n      image_url: ''\n  },\n  error: {\n      openError: false,\n      errMessage: ''\n  }\n}\n\nclass AdminLogin extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      ...initialState,\n      loignCode: props.url.query.code\n    }  \n  }\n\n  \n\n\n  componentDidMount() {\n    if (this.state.loignCode !== undefined) {\n        this.setState({saving: true})\n        fetch(`https://slack.com/api/oauth.access?client_id=128855814131.364624341426&client_secret=fcffdec17a2d48361b4467356339bc71&code=${this.state.loignCode}`)\n        .then((res) => res.json())\n        .then((data) => {\n            if (data.ok) {\n             this.saveUserData(data)\n            } else {\n                this.setState({error: {openError: true, errMessage: data}})\n            } \n         }\n        )\n    }\n  }\n\n  saveUserData(userReponse) {\n      const {user} = userReponse;\n      this.setState({user: { \n          firstName: user.name.split(' ')[0], \n          lastName: user.name.split(' ')[1],\n          image_url: user.image_192,\n          email: user.email\n      }})\n    fetch(`/api/update-create/${user.email}`, {\n        method: 'post',\n        headers: {\n          'Accept': 'application/json, text/plain, */*',\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(this.state.user)\n    })\n    .then((res) => res.json())\n    .then((data) => {\n        this.setState({saving: false, save: true})\n        localStorage.setItem('access_token', userReponse.access_token);\n        Router.push('/admin-home');\n    })\n  } \n \n\n  render() {\n      const state = this.state;\n    return (\n    <div>\n       <a style={{left: '45%', position: 'absolute', top: '45%'}} href=\"https://slack.com/oauth/authorize?scope=identity.basic,identity.email,identity.team,identity.avatar&client_id=128855814131.364624341426\"><img alt=\"Sign in with Slack\" height=\"40\" width=\"172\" src=\"https://platform.slack-edge.com/img/sign_in_with_slack.png\" srcset=\"https://platform.slack-edge.com/img/sign_in_with_slack.png 1x, https://platform.slack-edge.com/img/sign_in_with_slack@2x.png 2x\" /></a>\n    </div>\n    )\n  }\n}\n\n\nexport default AdminLogin\n\n\n// WEBPACK FOOTER //\n// pages/admin-login.js"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAJA;AAMA;AACA;AACA;AAFA;AATA;AACA;AAcA;;;;;AACA;AAAA;AACA;AADA;AACA;AAAA;AACA;AAEA;AAFA;AAFA;AAMA;AACA;;;AAIA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AACA;AACA;AAAA;AAEA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAEA;AACA;;;AAEA;AAAA;AACA;AADA;AAEA;AAAA;AACA;AACA;AACA;AACA;AAJA;AAAA;AAMA;AACA;AACA;AACA;AACA;AAFA;AAIA;AANA;AAQA;AAAA;AAEA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;;;;;;;;;AA5DA;AACA;AA+DA;AAAA;;;;;;;;;;;;AA/EA;AAeA;;;;;;;;;;;;;;;;;;;;;;;;;;;;A","sourceRoot":""}